<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <title>蘭潭–仁義潭｜歷年月平均合計有效蓄水量與運轉曲線(月平均)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Noto Sans TC", "PingFang TC", "Heiti TC", sans-serif;
      background: radial-gradient(circle at top left, #e0f2fe 0, #f9fafb 40%, #e5e7eb 100%);
    }
    .page {
      max-width: 1400px;
      margin: 0 auto;
      padding: 1.5rem 1rem 2rem;
    }
    .card {
      background: rgba(255,255,255,0.98);
      border-radius: 18px;
      box-shadow: 0 18px 45px rgba(15,23,42,0.12);
      padding: 1.8rem 2.2rem 2.2rem;
      backdrop-filter: blur(8px);
    }
    h1 {
      margin: 0 0 0.35rem 0;
      font-size: 1.45rem;
      font-weight: 650;
      letter-spacing: 0.03em;
      color: #0f172a;
    }
    .subtitle {
      margin: 0 0 0.85rem 0;
      font-size: 0.94rem;
      color: #4b5563;
    }
    .meta-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.6rem;
      font-size: 0.8rem;
      color: #6b7280;
      margin-bottom: 0.75rem;
    }
    .meta-pill {
      padding: 0.16rem 0.8rem;
      border-radius: 999px;
      background: #eff6ff;
      border: 1px solid #dbeafe;
      color: #1d4ed8;
    }
    #chart_month {
      width: 100%;
      height: 680px;
    }
    @media (max-width: 768px) {
      .card {
        padding: 1.3rem 1.3rem 1.6rem;
      }
      #chart_month {
        height: 520px;
      }
      h1 {
        font-size: 1.2rem;
      }
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
</head>
<body>
  <div class="page">
    <div class="card">
      <h1>蘭潭–仁義潭水庫｜歷年月平均合計有效蓄水量 vs 運轉曲線(月平均)</h1>
      <p class="subtitle">
        依你重新提供的 109–114 年「歷線圖」資料（工作表11），將每日合計有效蓄水量換算為百萬立方公尺，
        彙整為各月份的月平均；同時計算 109–113 年的 5 年平均，以及運轉曲線的月平均。
      </p>
      <div class="meta-row">
        <span class="meta-pill">資料來源：工作表「工作表11」</span>
        <span class="meta-pill">5 年平均：109–113 年每日值 → 月平均</span>
        <span class="meta-pill">113 年：1–12 月每日都有資料</span>
        <span class="meta-pill">114 年：11/17 之後與 12 月整月為缺值，不納入平均、不畫線段</span>
        <span class="meta-pill">單位：百萬立方公尺</span>
      </div>
      <div id="chart_month"></div>
    </div>
  </div>

  <script>
    const monthLabels = ["1月", "2月", "3月", "4月", "5月", "6月", "7月", "8月", "9月", "10月", "11月", "12月"];
    const chartMonthDom = document.getElementById('chart_month');
    const chartMonth = echarts.init(chartMonthDom);

    const optionMonth = {
      color: ["#2563eb", "#22c55e", "#f97316", "#a855f7", "#0ea5e9", "#9ca3af", "#111827", "#e11d48"],
      tooltip: {
        trigger: 'axis',
        axisPointer: {
          type: 'cross',
          label: {
            backgroundColor: '#0f172a',
            borderRadius: 4
          }
        },
        backgroundColor: 'rgba(15,23,42,0.96)',
        borderWidth: 0,
        textStyle: {
          fontSize: 13,
          color: '#e5e7eb'
        },
        padding: 10,
        formatter: function(params) {
          if (!params || params.length === 0) return '';
          const month = params[0].axisValue;
          let text = '<div style="font-size:13px;margin-bottom:4px;">月份：' + month + '</div>';
          params.forEach(p => {
            let value = '-';
            if (p.data != null && p.data !== '-') {
              value = p.data.toFixed(2) + ' 百萬立方公尺';
            }
            text += '<div style="line-height:1.5;">' + p.marker +
                    '<span style="display:inline-block;width:160px;">' + p.seriesName + '</span>' +
                    '<span style="font-variant-numeric:tabular-nums;">' + value + '</span></div>';
          });
          return text;
        }
      },
      legend: {
        top: 8,
        right: 10,
        textStyle: {
          fontSize: 11,
          color: '#374151'
        },
        itemWidth: 18,
        itemHeight: 10,
        icon: 'roundRect',
        data: ['114年', '113年', '112年', '111年', '110年', '109年', '5年平均(109-113年)', '運轉曲線(月平均)']
      },
      grid: {
        left: '7%',
        right: '4%',
        top: 80,
        bottom: 70
      },
      xAxis: {
        type: 'category',
        data: monthLabels,
        name: '時間（月）',
        nameLocation: 'middle',
        nameGap: 36,
        nameTextStyle: {
          fontSize: 13,
          color: '#4b5563',
          fontWeight: 500
        },
        axisLine: { lineStyle: { color: '#9ca3af' } },
        axisTick: { show: false },
        axisLabel: {
          color: '#4b5563',
          fontSize: 12
        }
      },
      yAxis: {
        type: 'value',
        name: '合計有效蓄水量（百萬立方公尺）',
        nameLocation: 'middle',
        nameGap: 60,
        nameTextStyle: {
          fontSize: 13,
          color: '#4b5563',
          fontWeight: 500
        },
        min: 4.5,
        max: 35.0,
        axisLine: { lineStyle: { color: '#9ca3af' } },
        axisTick: { show: false },
        axisLabel: {
          color: '#4b5563',
          fontSize: 12,
          formatter: function (value) { return value.toFixed(1); }
        },
        splitLine: {
          show: true,
          lineStyle: {
            color: '#d1d5db',
            width: 1,
            type: 'dashed'
          }
        }
      },
      series: [
        {
      name: '114年',
      type: 'line',
      smooth: true,
      showSymbol: true,
      symbolSize: 7,
      lineStyle: {
        width: 3,
        opacity: 1.0
      },
      data: [25.006, 21.627, 18.891, 15.571, 12.729, 20.865, 31.79, 32.651, 33.505, 31.694, 27.833, null]
    }, {
      name: '113年',
      type: 'line',
      smooth: true,
      showSymbol: true,
      symbolSize: 7,
      lineStyle: {
        width: 2,
        opacity: 1.0
      },
      data: [21.179, 17.428, 13.703, 10.43, 10.546, 24.767, 31.479, 32.771, 33.248, 32.523, 33.394, 29.765]
    }, {
      name: '112年',
      type: 'line',
      smooth: true,
      showSymbol: true,
      symbolSize: 7,
      lineStyle: {
        width: 2,
        opacity: 0.85
      },
      data: [16.691, 12.63, 10.269, 8.184, 7.313, 14.297, 25.971, 33.32, 33.109, 33.381, 31.455, 26.909]
    }, {
      name: '111年',
      type: 'line',
      smooth: true,
      showSymbol: true,
      symbolSize: 7,
      lineStyle: {
        width: 2,
        opacity: 0.7
      },
      data: [20.026, 17.007, 15.691, 13.776, 16.156, 31.402, 31.845, 32.872, 33.684, 30.542, 25.981, 21.625]
    }, {
      name: '110年',
      type: 'line',
      smooth: true,
      showSymbol: true,
      symbolSize: 7,
      lineStyle: {
        width: 2,
        opacity: 0.7
      },
      data: [19.818, 16.822, 14.624, 11.907, 9.012, 23.07, 33.425, 32.86, 32.86, 32.851, 29.761, 25.44]
    }, {
      name: '109年',
      type: 'line',
      smooth: true,
      showSymbol: true,
      symbolSize: 7,
      lineStyle: {
        width: 2,
        opacity: 0.7
      },
      data: [21.181, 17.938, 13.65, 10.851, 9.586, 22.606, 25.513, 32.776, 34.278, 30.946, 27.065, 23.459]
    }, {
      name: '5年平均(109-113年)',
      type: 'line',
      smooth: true,
      showSymbol: true,
      symbolSize: 8,
      lineStyle: {
        width: 4
      },
      data: [19.779, 16.365, 13.587, 11.029, 10.523, 23.229, 29.647, 32.92, 33.436, 32.049, 29.531, 25.439]
    }, {
      name: '運轉曲線(月平均)',
      type: 'line',
      smooth: true,
      showSymbol: true,
      symbolSize: 8,
      lineStyle: {
        width: 3,
        type: 'dashed'
      },
      data: [18.6, 14.514, 11.885, 7.9, 5.0, 12.75, 23.36, 30.658, 33.723, 32.035, 28.366, 23.439]
    }
      ]
    };

    chartMonth.setOption(optionMonth);
    window.addEventListener('resize', function () {
      chartMonth.resize();
    });
  </script>
</body>
</html>
